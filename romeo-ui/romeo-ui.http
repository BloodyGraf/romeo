<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Local WebRTC PoC</title>
  <style>
    body { background: #111; color: #eee; font-family: sans-serif; text-align: center; }
    video { width: 45%; margin: 10px; border-radius: 8px; background: #000; }
    button { margin-top: 20px; padding: 8px 16px; }
  </style>
</head>
<body>
  <h2>ðŸ§  WebRTC Local Test</h2>
  <video id="localVideo" autoplay playsinline muted></video>
  <video id="remoteVideo" autoplay playsinline></video>
  <div><button id="startBtn">Start Local Call</button></div>

  <script>
    const startBtn = document.getElementById('startBtn');
    const localVideo = document.getElementById('localVideo');
    const remoteVideo = document.getElementById('remoteVideo');

    startBtn.onclick = async () => {
      const localStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: false });
      localVideo.srcObject = localStream;

      const pc1 = new RTCPeerConnection();
      const pc2 = new RTCPeerConnection();

      pc1.onicecandidate = e => e.candidate && pc2.addIceCandidate(e.candidate);
      pc2.onicecandidate = e => e.candidate && pc1.addIceCandidate(e.candidate);

      pc2.ontrack = e => remoteVideo.srcObject = e.streams[0];
      localStream.getTracks().forEach(track => pc1.addTrack(track, localStream));

      const offer = await pc1.createOffer();
      await pc1.setLocalDescription(offer);
      await pc2.setRemoteDescription(offer);

      const answer = await pc2.createAnswer();
      await pc2.setLocalDescription(answer);
      await pc1.setRemoteDescription(answer);

      console.log('âœ… Local loop established');
    };
  </script>
</body>
</html>